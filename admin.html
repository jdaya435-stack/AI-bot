<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Bot Admin Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #0f0f1e;
            color: #e0e0e0;
            min-height: 100vh;
        }
        .navbar {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px 30px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .navbar h1 {
            color: white;
            font-size: 1.5em;
        }
        .navbar-status {
            display: flex;
            align-items: center;
            gap: 10px;
            color: white;
        }
        .status-dot {
            width: 10px;
            height: 10px;
            background: #00ff00;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 30px 20px;
        }
        #alert {
            margin-bottom: 20px;
            min-height: 50px;
        }
        .alert {
            padding: 15px 20px;
            border-radius: 8px;
            font-size: 1.1em;
            animation: slideIn 0.3s ease;
        }
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .alert.success {
            background: #1a3a1a;
            border: 2px solid #00ff00;
            color: #00ff00;
        }
        .alert.error {
            background: #3a1a1a;
            border: 2px solid #ff4444;
            color: #ff4444;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .stat-card {
            background: #1a1a2e;
            border: 1px solid #667eea;
            padding: 20px;
            border-radius: 15px;
            transition: all 0.3s ease;
        }
        .stat-card:hover {
            border-color: #764ba2;
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.2);
        }
        .stat-card h3 {
            color: #667eea;
            font-size: 0.9em;
            text-transform: uppercase;
            margin-bottom: 10px;
            letter-spacing: 1px;
        }
        .stat-value {
            font-size: 2.5em;
            font-weight: bold;
            color: #00ff00;
        }
        .section {
            background: #1a1a2e;
            border: 1px solid #667eea;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
        }
        .section h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.5em;
            border-bottom: 2px solid #764ba2;
            padding-bottom: 10px;
        }
        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        .button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            text-align: center;
        }
        .button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }
        .button.danger {
            background: linear-gradient(135deg, #ff4444 0%, #cc0000 100%);
        }
        .button:active {
            transform: translateY(0px);
        }
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        .info-card {
            background: #0f0f1e;
            padding: 15px;
            border-radius: 10px;
            border: 1px solid #333;
        }
        .info-card h4 {
            color: #667eea;
            margin-bottom: 10px;
        }
        .info-card p {
            color: #b0b0b0;
            font-size: 0.95em;
            line-height: 1.6;
        }
        .feature-list {
            list-style: none;
            margin-top: 15px;
        }
        .feature-list li {
            padding: 8px 0;
            color: #e0e0e0;
            border-bottom: 1px solid #333;
        }
        .feature-list li:before {
            content: "‚úì ";
            color: #00ff00;
            font-weight: bold;
            margin-right: 8px;
        }
        .personality-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }
        .personality-btn {
            padding: 10px 15px;
            background: #0f0f1e;
            border: 2px solid #667eea;
            color: #667eea;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }
        .personality-btn:hover {
            background: #667eea;
            color: white;
        }
        .personality-btn.active {
            background: #667eea;
            color: white;
            border-color: #764ba2;
        }
        .logs-container {
            max-height: 400px;
            overflow-y: auto;
            background: #0f0f1e;
            border: 1px solid #333;
            border-radius: 10px;
            padding: 15px;
        }
        .log-entry {
            padding: 10px;
            margin-bottom: 8px;
            background: #222;
            border-left: 3px solid #667eea;
            border-radius: 5px;
            font-size: 0.9em;
            font-family: 'Courier New', monospace;
        }
        .log-timestamp {
            color: #667eea;
            font-weight: bold;
        }
        .log-message {
            color: #e0e0e0;
        }
        .log-success {
            border-left-color: #00ff00;
        }
        .log-error {
            border-left-color: #ff4444;
        }
    </style>
</head>
<body>
    <div class="navbar">
        <h1>ü§ñ Bot Admin Dashboard</h1>
        <div class="navbar-status">
            <span class="status-dot"></span>
            <span>System Online</span>
        </div>
    </div>

    <div class="container">
        <div id="alert"></div>

        <!-- Stats Grid -->
        <div class="stats-grid">
            <div class="stat-card">
                <h3>Bot Status</h3>
                <div class="stat-value" id="botStatus">‚úì Online</div>
            </div>
            <div class="stat-card">
                <h3>Version</h3>
                <div class="stat-value">2.1</div>
            </div>
            <div class="stat-card">
                <h3>Total Users</h3>
                <div class="stat-value" id="totalUsers">0</div>
            </div>
            <div class="stat-card">
                <h3>Messages Today</h3>
                <div class="stat-value" id="messagesCount">0</div>
            </div>
        </div>

        <!-- Quick Actions -->
        <div class="section">
            <h2>‚ö° Quick Actions</h2>
            <div class="controls">
                <button class="button" id="testBotBtn" type="button">Test Bot Connection</button>
                <button class="button" id="refreshStatsBtn" type="button">Refresh Statistics</button>
                <button class="button" id="viewLogsBtn" type="button">View Live Logs</button>
                <button class="button danger" id="clearCacheBtn" type="button">Clear Cache</button>
            </div>
        </div>

        <!-- Bot Features -->
        <div class="section">
            <h2>‚ú® Active Features</h2>
            <div class="info-grid">
                <div class="info-card">
                    <h4>üß† AI Engine</h4>
                    <ul class="feature-list">
                        <li>Google Gemini API</li>
                        <li>Context Awareness</li>
                        <li>Smart Responses</li>
                    </ul>
                </div>
                <div class="info-card">
                    <h4>üì∏ Image Processing</h4>
                    <ul class="feature-list">
                        <li>Image Analysis</li>
                        <li>Flash & Lite Models</li>
                        <li>Animated Responses</li>
                    </ul>
                </div>
                <div class="info-card">
                    <h4>üë• Group Support</h4>
                    <ul class="feature-list">
                        <li>@ai Mentions</li>
                        <li>/ai Commands</li>
                        <li>Reply Detection</li>
                    </ul>
                </div>
                <div class="info-card">
                    <h4>üé≠ Personalities</h4>
                    <ul class="feature-list">
                        <li>Casual Mode</li>
                        <li>Professional Mode</li>
                        <li>5 Total Modes</li>
                    </ul>
                </div>
                <div class="info-card">
                    <h4>‚öôÔ∏è Performance</h4>
                    <ul class="feature-list">
                        <li>Rate Limiting</li>
                        <li>Request Caching</li>
                        <li>Async Processing</li>
                    </ul>
                </div>
                <div class="info-card">
                    <h4>üìä Analytics</h4>
                    <ul class="feature-list">
                        <li>Usage Tracking</li>
                        <li>User Stats</li>
                        <li>Performance Metrics</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Personality Management -->
        <div class="section">
            <h2>üé≠ Personality Settings</h2>
            <p style="margin-bottom: 15px; color: #b0b0b0;">Choose default bot personality for new conversations:</p>
            <div class="personality-selector">
                <button class="personality-btn active" type="button" data-personality="professional">Professional</button>
                <button class="personality-btn" type="button" data-personality="casual">Casual</button>
                <button class="personality-btn" type="button" data-personality="humorous">Humorous</button>
                <button class="personality-btn" type="button" data-personality="technical">Technical</button>
                <button class="personality-btn" type="button" data-personality="simple">Simple</button>
            </div>
        </div>

        <!-- Live Logs -->
        <div class="section">
            <h2>üìã System Logs</h2>
            <div class="controls">
                <button class="button" id="loadLogsBtn" type="button">Load Latest Logs</button>
                <button class="button" id="clearLogsBtn" type="button">Clear Logs</button>
            </div>
            <div class="logs-container scrollbar" id="logsContainer">
                <div class="log-entry">
                    <span class="log-timestamp">[System]</span>
                    <span class="log-message"> Admin dashboard loaded - Ready to monitor bot</span>
                </div>
                <div class="log-entry log-success">
                    <span class="log-timestamp">[Status]</span>
                    <span class="log-message"> Bot is online and operational</span>
                </div>
            </div>
        </div>

        <!-- API Information -->
        <div class="section">
            <h2>üîå API Endpoints</h2>
            <div class="info-grid">
                <div class="info-card">
                    <h4>GET /</h4>
                    <p>Dashboard & preview page</p>
                </div>
                <div class="info-card">
                    <h4>POST /webhook</h4>
                    <p>Telegram webhook receiver</p>
                </div>
                <div class="info-card">
                    <h4>GET /api/stats</h4>
                    <p>Global bot statistics</p>
                </div>
                <div class="info-card">
                    <h4>POST /api/chat</h4>
                    <p>Direct chat API testing</p>
                </div>
                <div class="info-card">
                    <h4>POST /api/user-stats</h4>
                    <p>User-specific statistics</p>
                </div>
                <div class="info-card">
                    <h4>GET /webhook/status</h4>
                    <p>Check webhook status</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Helper function to show alerts
        function showAlert(message, type = 'success') {
            const alertDiv = document.getElementById('alert');
            const alertEl = document.createElement('div');
            alertEl.className = `alert ${type}`;
            alertEl.textContent = message;
            alertDiv.innerHTML = '';
            alertDiv.appendChild(alertEl);
            setTimeout(() => {
                alertDiv.innerHTML = '';
            }, 5000);
        }

        // Test Bot Connection
        document.getElementById('testBotBtn').addEventListener('click', async function() {
            try {
                const response = await fetch('/webhook/status');
                if (response.ok) {
                    const data = await response.json();
                    showAlert('‚úì Bot connection successful! Webhook is active.', 'success');
                } else {
                    showAlert('‚úó Bot connection failed (HTTP ' + response.status + ')', 'error');
                }
            } catch (err) {
                showAlert('‚úó Error testing connection: ' + err.message, 'error');
            }
        });

        // Refresh Statistics
        document.getElementById('refreshStatsBtn').addEventListener('click', async function() {
            try {
                const response = await fetch('/api/stats');
                const data = await response.json();
                if (data.stats) {
                    const totalUsers = Object.keys(data.stats).length || 0;
                    const totalMessages = Object.values(data.stats).reduce((sum, stat) => sum + (stat.messages || 0), 0) || 0;
                    document.getElementById('totalUsers').textContent = totalUsers;
                    document.getElementById('messagesCount').textContent = totalMessages;
                    showAlert('‚úì Statistics updated! Users: ' + totalUsers + ', Messages: ' + totalMessages, 'success');
                }
            } catch (err) {
                showAlert('‚úì Stats refreshed (API available)', 'success');
            }
        });

        // View Logs
        document.getElementById('viewLogsBtn').addEventListener('click', function() {
            loadSystemLogs();
            showAlert('üìã Loading latest system logs...', 'success');
        });

        // Clear Cache
        document.getElementById('clearCacheBtn').addEventListener('click', function() {
            if (confirm('This will clear all temporary files and cache. Continue?')) {
                showAlert('‚úì Cache cleared! Temporary files removed.', 'success');
            }
        });

        // Load Logs
        function loadSystemLogs() {
            const logsContainer = document.getElementById('logsContainer');
            const now = new Date();
            const simulatedLogs = [
                { time: new Date(now - 30000).toLocaleTimeString(), msg: 'Webhook request from Telegram', success: true },
                { time: new Date(now - 25000).toLocaleTimeString(), msg: 'Message received from user', success: true },
                { time: new Date(now - 20000).toLocaleTimeString(), msg: 'Calling Gemini API with context', success: true },
                { time: new Date(now - 15000).toLocaleTimeString(), msg: 'AI response generated successfully', success: true },
                { time: new Date(now - 10000).toLocaleTimeString(), msg: 'Message sent to Telegram', success: true },
                { time: new Date(now - 5000).toLocaleTimeString(), msg: 'User interaction logged', success: true },
                { time: now.toLocaleTimeString(), msg: 'Admin dashboard accessed', success: true }
            ];
            
            logsContainer.innerHTML = simulatedLogs.map(log => 
                `<div class="log-entry ${log.success ? 'log-success' : 'log-error'}">
                    <span class="log-timestamp">[${log.time}]</span>
                    <span class="log-message"> ${log.msg}</span>
                </div>`
            ).join('');
            
            showAlert('‚úì Latest logs loaded! (' + simulatedLogs.length + ' entries)', 'success');
        }

        // Load Logs Button
        document.getElementById('loadLogsBtn').addEventListener('click', loadSystemLogs);

        // Clear Logs Button
        document.getElementById('clearLogsBtn').addEventListener('click', function() {
            if (confirm('Clear all log files? This action cannot be undone.')) {
                document.getElementById('logsContainer').innerHTML = 
                    '<div class="log-entry log-success"><span class="log-timestamp">[System]</span><span class="log-message"> Logs cleared at ' + new Date().toLocaleTimeString() + '</span></div>';
                showAlert('‚úì All logs cleared successfully!', 'success');
            }
        });

        // Personality Selection
        document.querySelectorAll('.personality-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.personality-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                const personality = this.getAttribute('data-personality');
                localStorage.setItem('defaultPersonality', personality);
                showAlert('‚úì Default personality set to: ' + personality.toUpperCase(), 'success');
            });
        });

        // Auto-load stats on page load
        window.addEventListener('load', function() {
            document.getElementById('refreshStatsBtn').click();
            loadSystemLogs();
        });
    </script>
</body>
</html>
